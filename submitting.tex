% $Id$
\documentclass{ansarticle}

\title{Preparing and submitting articles for the Archive of Numerical
  Software}
\author[1]{Wolfgang Bangerth}
\author[2]{Peter Bastian}
\author[1]{Guido Kanschat\thanks{NSF}}
\author[3]{Michael Heroux}
\author[4]{Anders Logg}
\affil[1]{Department of Mathematics, Texas A\&M University}
\affil[2]{IWR, Universit\"at Heidelberg}
\affil[3]{Sandia National Laboratories}
\affil[4]{Simula, Oslo}
\runningtitle{Preparing articles for ANS}
\runningauthor{Bangerth, Bastian, Kanschat, Heroux, Logg}

\begin{document}

\maketitle

\begin{abstract}
  This document describes the general structure of the
  \texttt{ansarticle} document class and serves as an example for its
  usage. \texttt{ansarticle.cls} is based on the standard \LaTeX{}
  \texttt{article.cls} as well as a few other standard packages. It
  fixes most style parameters to the preferred style of the Archive of
  Numerical Software.
\end{abstract}

\section{Implementation}

The file \texttt{ansarticle.cls} loads the standard LaTeX
\texttt{article.cls} and applies some changes to the layout.

\subsection{Requirements}

Test ccc $f(x) = u$

Upon loading, \texttt{ansarticle.cls} requires the following packages:

\begin{itemize}
\item \texttt{times} and \texttt{mathptm} to use postscript fonts
\item \texttt{hyperref} in order to typeset hyper-links in the text
\item \texttt{fancyhdr} for page headers and footers
\item \texttt{authblk} for more convenient handling of author and
  affiliation lists
\item \texttt{listings} for source code listings
\end{itemize}
These packages are part of standard \TeX{} distributions.

\section{Usage}

Fill some pages so we see what it looks like:

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas
vestibulum justo ut felis porttitor at egestas mauris varius. Etiam
risus nibh, posuere vitae laoreet vitae, consectetur id risus. Vivamus
adipiscing diam eget enim congue vel ultrices mi dignissim. Nullam
volutpat, nunc eu ullamcorper tempus, eros orci rutrum enim, ac luctus
nulla urna et felis. Sed auctor, dolor vel pellentesque tempus, magna
tellus feugiat enim, nec rhoncus augue est sit amet nisl. Curabitur ac
nisi eu orci porttitor egestas in sed tortor. Aliquam tincidunt orci
vitae magna luctus eu gravida dolor hendrerit. Duis sit amet metus
justo, vitae scelerisque neque. Nam vitae nisi eros. Curabitur
convallis faucibus elit ut auctor. Morbi vel urna sit amet nisi
pharetra laoreet. Maecenas vitae enim elit. Donec varius orci nisi, id
blandit elit. Aliquam ornare pharetra ante, in porttitor erat mollis
sed. Suspendisse potenti. Donec id tortor odio, et egestas
eros. Aenean nec orci at diam porta tincidunt. Nam molestie tempus
vestibulum. Praesent sed felis at est sodales elementum laoreet non
risus. Nam urna augue, pulvinar et adipiscing vita
e, auctor at sem.

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas
vestibulum justo ut felis porttitor at egestas mauris varius. Etiam
risus nibh, posuere vitae laoreet vitae, consectetur id risus. Vivamus
adipiscing diam eget enim congue vel ultrices mi dignissim. Nullam
volutpat, nunc eu ullamcorper tempus, eros orci rutrum enim, ac luctus
nulla urna et felis. Sed auctor, dolor vel pellentesque tempus, magna
tellus feugiat enim, nec rhoncus augue est sit amet nisl. Curabitur ac
nisi eu orci porttitor egestas in sed tortor. Aliquam tincidunt orci
vitae magna luctus eu gravida dolor hendrerit. Duis sit amet metus
justo, vitae scelerisque neque. Nam vitae nisi eros. Curabitur
convallis faucibus elit ut auctor. Morbi vel urna sit amet nisi
pharetra laoreet. Maecenas vitae enim elit. Donec varius orci nisi, id
blandit elit. Aliquam ornare pharetra ante, in porttitor erat mollis
sed. Suspendisse potenti. Donec id tortor odio, et egestas
eros. Aenean nec orci at diam porta tincidunt. Nam molestie tempus
vestibulum. Praesent sed felis at est sodales elementum laoreet non
risus. Nam urna augue, pulvinar et adipiscing vita
e, auctor at sem.

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas
vestibulum justo ut felis porttitor at egestas mauris varius. Etiam
risus nibh, posuere vitae laoreet vitae, consectetur id risus. Vivamus
adipiscing diam eget enim congue vel ultrices mi dignissim. Nullam
volutpat, nunc eu ullamcorper tempus, eros orci rutrum enim, ac luctus
nulla urna et felis. Sed auctor, dolor vel pellentesque tempus, magna
tellus feugiat enim, nec rhoncus augue est sit amet nisl. Curabitur ac
nisi eu orci porttitor egestas in sed tortor. Aliquam tincidunt orci
vitae magna luctus eu gravida dolor hendrerit. Duis sit amet metus
justo, vitae scelerisque neque. Nam vitae nisi eros. Curabitur
convallis faucibus elit ut auctor. Morbi vel urna sit amet nisi
pharetra laoreet. Maecenas vitae enim elit. Donec varius orci nisi, id
blandit elit. Aliquam ornare pharetra ante, in porttitor erat mollis
sed. Suspendisse potenti. Donec id tortor odio, et egestas
eros. Aenean nec orci at diam porta tincidunt. Nam molestie tempus
vestibulum. Praesent sed felis at est sodales elementum laoreet non
risus. Nam urna augue, pulvinar et adipiscing vita
e, auctor at sem.

\section{Testing some math}

Consider $f(x) = x^2$

\section{Code samples}

All code listings are based on the \texttt{listings}
package~\cite{HeinzMoses07}.  The style file \texttt{anslistings.sty},
automatically included by \texttt{ansarticle.cls}, provides standard
styles for a variety of common programming languages. Changing any
listing style parameters is not encouraged and may lead to unexpected
outcomes in the final publication.

Below, we provide samples of listings for the languages available. If
a language is missing, please contact the managing editor for an
updated style file.

\subsection{C++}

C++ code should be compliant with the current C++ standard. Two
commands are provided to prettyprint C++ code. First, an environment
to put C++ code into the LaTeX file, namely

\begin{latexcode}
\begin{c++}
  // Your C++ code here
\end{c++}
\end{latexcode}

Alternatively, it is possible to use \lstinline[language=TeX]!\inputcpp{file.cc}!
to print the C++ code in a file. Here is an example what C++ code
looks like.

\begin{c++}
// Get dimensions of local mesh_data
const unsigned int num_local_cells = mesh_data.cell_vertices.size();
assert(global_cell_indices.size() == num_local_cells);
const unsigned int num_cell_vertices = mesh_data.cell_vertices[0].size();

// Build array of cell-vertex connectivity and partition vector
std::vector<unsigned int> cell_vertices;
std::vector<unsigned int> cell_vertices_partition;
const unsigned int size = num_local_cells*(num_cell_vertices + 1);
cell_vertices.reserve(size);
cell_vertices_partition.reserve(size);
for (unsigned int i = 0; i < num_local_cells; i++)
{
  cell_vertices.push_back(global_cell_indices[i]);
  cell_vertices_partition.push_back(cell_partition[i]);
  for (unsigned int j = 0; j < num_cell_vertices; j++)
  {
    cell_vertices.push_back(mesh_data.cell_vertices[i][j]);
    cell_vertices_partition.push_back(cell_partition[i]);
  }
}

// Distribute cell-vertex connectivity
MPI::distribute(cell_vertices, cell_vertices_partition);
assert(cell_vertices.size());
cell_vertices_partition.clear();
\end{c++}

\subsection{Python}
\begin{python}
# Time-stepping
t = dt
p = Progress("Time-stepping")
while t < T + DOLFIN_EPS:

    # Update pressure boundary condition
    p_in.t = t

    # Compute tentative velocity step
    begin("Computing tentative velocity")
    b1 = assemble(L1)
    [bc.apply(A1, b1) for bc in bcu]
    solve(A1, u1.vector(), b1, "gmres", "ilu")
    end()

    # Pressure correction
    begin("Computing pressure correction")
    b2 = assemble(L2)
    [bc.apply(A2, b2) for bc in bcp]
    solve(A2, p1.vector(), b2, "gmres", "amg_hypre")
    end()

    # Velocity correction
    begin("Computing velocity correction")
    b3 = assemble(L3)
    [bc.apply(A3, b3) for bc in bcu]
    solve(A3, u1.vector(), b3, "gmres", "ilu")
    end()

    # Plot solution
    plot(p1, title="Pressure", rescale=True)
    plot(u1, title="Velocity", rescale=True)

    # Save to file
    ufile << u1
    pfile << p1

    # Move to next time step
    u0.assign(u1)
    p.update(t / T)
    t += dt
\end{python}

\bibliographystyle{abbrv}
\bibliography{submitting}
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
